# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据获取和预处理的方法
- 傅里叶变换的实现方式
- 功率谱的计算方法
- 峰值检测和周期确定的策略

1.数据获取与预处理
通过load_sunspot_data函数从本地文件（sunspot_data.txt）加载数据，使用numpy.loadtxt读取年份和太阳黑子数列。注释中还包含从URL获取数据的备用代码，但未被实际调用。数据预处理仅保留有效数值，未进行插值或平滑处理。

2.傅里叶变换实现
在compute_power_spectrum函数中，直接调用np.fft.fft对太阳黑子数据进行快速傅里叶变换（FFT），将时域信号转换为频域表示。FFT结果包含正负频率，后续仅使用正频率部分以简化分析。

3.功率谱计算方法
功率谱通过取FFT结果的绝对值平方（np.abs(fft_result)**2）得到，反映信号在不同频率上的能量分布。横轴频率通过np.fft.fftfreq生成，转换为周期（月）后绘图。

4.峰值检测与周期确定
主周期通过find_main_period函数定位功率谱中的最高峰值（忽略零频），其对应周期为1/frequency。代码输出主周期（月）并转换为年单位，验证了太阳活动的11年周期特征。

## 3. 实验结果

### 3.1 太阳黑子数据时间序列

![Figure_1](https://github.com/user-attachments/assets/a34e1000-8e92-4cb9-8073-2aac744ab031)

图像说明：

该图展示了自1749年至今太阳黑子数量的变化趋势。横轴为年份，纵轴为太阳黑子数。图中可见明显的周期性波动，峰值和谷值交替出现，周期约为11年，这是太阳活动的基本周期。此外，不同周期的峰值高度不一，表明太阳活动强度存在长期变化。整体来看，太阳黑子数在20世纪后半叶达到较高水平，可能与现代太阳活动增强有关。
### 3.2 功率谱分析

![Figure_2](https://github.com/user-attachments/assets/a0956daa-a56b-49a1-856e-be0dbdc50eb4)

图像说明：

该图是太阳黑子数据的功率谱分析结果，横轴为周期（月），纵轴为功率。图中显著峰值对应的周期约为132个月（11年），证实了太阳活动的11年周期。其他较小峰值可能反映次级的周期成分或噪声。功率谱分析揭示了太阳黑子变化的主要频率特征，为研究太阳活动规律提供了重要依据。

### 3.3 周期确定

请列出您通过不同方法确定的太阳黑子周期：

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 | 138.00  |   11.50   |
| 傅里叶分析 | 132.64 |   11.05   |

两种方法的相对误差： 4.07%

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

请讨论太阳黑子周期的物理成因及其对地球的影响：
- 太阳黑子形成的物理机制是什么？
- 太阳黑子周期与太阳磁场活动有什么关系？
- 太阳黑子活动对地球气候、通信系统等有何影响？

_在此处填写您的分析（约200字）_

### 4.2 傅里叶变换方法的优缺点

讨论使用傅里叶变换分析周期性信号的优缺点：
- 傅里叶变换在分析周期性信号时的优势是什么？
- 在本实验中，傅里叶变换方法可能存在哪些局限性？
- 有哪些其他方法可以用来分析时间序列的周期性？它们与傅里叶变换相比有何异同？

_在此处填写您的讨论（约200字）_

### 4.3 思考题

1. 如果太阳黑子数据中存在长期趋势（如逐年增加或减少的趋势），这会如何影响傅里叶分析的结果？应该如何处理这种趋势？

_在此处填写您的回答（约100字）_

2. 太阳黑子数据从1749年开始记录，到现在已有270多年的数据。如果我们只使用最近100年的数据进行分析，结果会有什么不同？为什么？

_在此处填写您的回答（约100字）_

## 5. 结论

总结本实验的主要发现和收获，包括对太阳黑子周期性的认识以及傅里叶变换在周期性分析中的应用。

_在此处填写您的结论（约150字）_

## 核心代码片段

请粘贴您实现的关键函数代码（如傅里叶变换和功率谱计算），并简要说明代码的核心思路。

```python
# 在此处粘贴核心代码片段（不超过30行）
```

代码说明：
_在此处简要解释代码的实现思路（约100字）_
