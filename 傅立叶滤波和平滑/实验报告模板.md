# 傅立叶滤波和平滑 - 实验报告

## 1. 实验目的

本实验旨在通过对道琼斯工业平均指数数据进行傅立叶变换和滤波处理，达到以下目标：
- 掌握傅立叶变换在金融时间序列分析中的应用
- 理解不同频率成分对信号的影响
- 学习通过频域滤波提取信号特征的方法
- 分析滤波参数变化对结果的影响

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据加载和预处理的方法
- 傅立叶变换和逆变换的实现
- 滤波器的设计原理（保留前10%和前2%系数的实现）
- 可视化方法的选择

1.数据加载和预处理

使用 numpy.loadtxt 直接从文本文件 dow.txt 加载道琼斯工业平均指数数据，未进行额外预处理（如归一化或去噪），以保持原始数据的真实性。若文件读取失败，程序会捕获异常并提示错误。

2.傅立叶变换和逆变换

傅立叶变换：采用 np.fft.rfft 计算实数信号的离散傅立叶变换（DFT），得到频域复数系数。该函数仅返回非冗余的正频率部分，提高计算效率。

逆变换：使用 np.fft.irfft 将滤波后的频域系数转换回时域信号，并通过 n 参数确保输出长度与原始数据一致，避免截断或填充。

3.滤波器设计

保留前10%或2%系数：通过设定 keep_fraction（0.1 或 0.02），计算保留的系数数量 cutoff，并将后续高频系数置零，仅保留低频成分。这种低通滤波方式有效提取信号的主要趋势，同时抑制高频噪声和短期波动。

4.可视化方法

使用 matplotlib 绘制原始数据、滤波结果的对比图，采用绿色（原始）和红色（滤波）曲线区分，并添加图例、标题和网格线以增强可读性。图像尺寸统一为 (10, 5) 英寸，平衡细节展示与布局紧凑性，便于观察信号平滑效果和频率成分的影响。

## 3. 实验结果

### 3.1 原始数据时间序列

![Figure_1](https://github.com/user-attachments/assets/aabff85b-47b2-4c02-8ce9-09034f53ee75)

图像说明：

原始数据展示了道琼斯工业平均指数随时间变化的趋势。从图中可以看出，指数呈现出一定的波动性，既有短期的快速变化，也有长期的趋势性运动。整体上，数据可能包含高频的日常波动和低频的长期趋势。这种复杂的波动模式使得直接分析较为困难，因此需要通过傅立叶变换将其分解为不同频率的成分，以便进一步处理和分析。

### 3.2 保留前10%系数的滤波结果

![Figure_2](https://github.com/user-attachments/assets/54c0a3f7-4a27-4723-9fa1-2fa152aeb289)

图像说明：

差异：滤波后的信号相较于原始信号更加平滑，保留了主要的趋势性变化，但去除了许多高频的短期波动。这表明前10%的低频系数主导了信号的主要特征。

被抑制的频率成分：被抑制的高频成分主要对应短期波动或噪声。去除这些成分后，信号的整体趋势更加清晰，但可能丢失了一些重要的短期细节，如小幅度的快速涨跌。

### 3.3 保留前2%系数的滤波结果

![Figure_3](https://github.com/user-attachments/assets/fe51c226-773a-4659-8e5a-d1b6794b94b3)

图像说明：

与10%滤波的对比：2%的滤波结果比10%的结果更加平滑，进一步抑制了更多的高频成分，仅保留了最低频的信号特征。这表明信号的长期趋势主要由极少数低频成分决定。

更严格滤波的影响：严格的滤波虽然突出了长期趋势，但可能导致信号过度平滑，丢失了部分有意义的中期波动信息。这种处理适用于关注长期趋势的场景，但对短期分析可能不适用。

## 4. 分析与讨论

### 4.1 不同滤波参数的影响

请讨论：
- 保留10%系数与保留2%系数结果的差异
- 不同滤波强度对信号平滑程度的影响
- 过度滤波可能导致的问题

保留10%与2%系数的差异
保留10%系数的滤波结果保留了较多的中低频成分，能反映较明显的趋势和部分短期波动；而2%的滤波仅保留极低频成分，信号更加平滑，但丢失了更多细节，仅呈现长期趋势。

滤波强度对平滑程度的影响
滤波强度（保留系数的比例）直接决定平滑程度：保留系数越少，高频成分被抑制越多，信号越平滑，但可能过度简化。10%的滤波适合平衡趋势与细节，2%的滤波则更适合提取长期规律。

过度滤波的问题
过度滤波（如2%）可能导致信号失真，丢失有意义的波动信息（如中期趋势或突发事件的影响），使分析结果过于笼统，降低模型的实用性。需根据实际需求权衡平滑程度与信息保留。
### 4.2 金融时间序列的频率特征

讨论道琼斯指数中不同频率成分可能代表的经济现象：
- 低频成分（长期趋势）反映了什么经济因素？
- 高频成分（短期波动）通常由什么因素引起？

低频成分（长期趋势）
低频信号对应指数的长期趋势，主要反映宏观经济基本面，如GDP增长、货币政策、产业结构变化等。这些因素通常以年或数年为单位影响市场，形成缓慢但稳定的上升或下降趋势。例如，长期牛市可能源于低利率环境或技术创新驱动的生产力提升。

高频成分（短期波动）
高频信号代表短期波动，通常由市场情绪、突发事件或流动性变化引起。例如：

市场情绪：投资者对新闻（如财报、政策）的即时反应；

流动性冲击：高频交易或短期资金流动导致的瞬时波动；

黑天鹅事件：如地缘冲突、疫情爆发等不可预测的冲击。

### 4.3 思考题

1. 如果我们对道琼斯指数数据进行对数变换后再进行傅立叶分析，结果会有什么不同？

对道琼斯指数进行对数变换（如计算对数收益率）后再进行傅立叶分析，主要会带来以下差异：

平稳性增强：对数变换可压缩数据尺度，减少指数级增长趋势对频谱的干扰，使高频成分更易识别；

频谱解释变化：低频成分将更反映相对增长率而非绝对价格波动，高频成分则对应对数收益率的短期波动，更符合金融时间序列的统计分析习惯。

抗噪性提升：对数变换能弱化极端值的影响，使滤波后的信号更稳健。这种方法更适合分析百分比变化而非原始价格。

2. 傅立叶变换假设信号是周期性的，但金融数据通常不是严格周期性的。这会导致什么问题？

傅立叶变换的周期性假设与金融数据的非周期性特征会导致以下问题：

频谱泄露：由于实际数据首尾不连续，变换时会引入虚假高频成分，干扰真实频率分布；

边界效应：非周期信号的截断会扭曲低频趋势，可能误判长期经济规律；

伪周期性解读：强制的周期分解可能将随机波动误认为周期信号。需结合加窗或时频分析来缓解。

## 5. 结论

总结本实验的主要发现和收获，包括：
- 傅立叶滤波在金融数据分析中的应用价值
- 不同滤波参数的选择经验
- 实验过程中遇到的挑战和解决方法

应用价值：傅立叶滤波能有效分离金融数据的长期趋势与短期波动，低频成分反映宏观经济基本面（如货币政策、产业周期），高频成分对应市场情绪和突发事件噪声。这种频域分析方法为量化金融研究提供了新视角。

参数选择经验：保留10%系数可平衡趋势提取与细节保留，适合多数分析场景；2%系数虽突出长期趋势，但会过度平滑。实际应用中需根据分析目标（如趋势跟踪/噪声过滤）动态调整参数。

挑战与解决：主要挑战是金融数据的非周期性与傅立叶变换的周期性假设冲突，导致频谱泄露。通过对比不同滤波强度、结合对数变换提升平稳性，有效缓解了该问题。实验还提示未来可尝试小波变换等非周期性分析方法。

## 核心代码片段

请粘贴您实现的关键函数代码（如滤波函数实现），并简要说明代码的核心思路。

```python
def fourier_filter(data, keep_fraction=0.1):
    """
    执行傅立叶变换并滤波
    
    参数:
        data (numpy.ndarray): 输入数据数组
        keep_fraction (float): 保留的傅立叶系数比例
    
    返回:
        tuple: (滤波后的数据数组, 原始傅立叶系数数组)
    """
    # 计算实数信号的傅立叶变换
    fft_coeff = np.fft.rfft(data)
    
    # 计算保留的系数数量
    cutoff = int(len(fft_coeff) * keep_fraction)
    
    # 创建滤波后的系数数组
    filtered_coeff = fft_coeff.copy()
    filtered_coeff[cutoff:] = 0
    
    # 计算逆变换
    filtered_data = np.fft.irfft(filtered_coeff, n=len(data))
    
    return filtered_data, fft_coeff

def plot_comparison(original, filtered, title="Fourier Filter Result"):
    """
    绘制原始数据和滤波结果的比较
    """
    fig = plt.figure(figsize=(10, 5))
    plt.plot(original, 'g-', linewidth=1, label="Original Data")
    plt.plot(filtered, 'r-', linewidth=2, label="Filtered Result")
    plt.title(title)
    plt.xlabel("Trading Day")
    plt.ylabel("Index Value")
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.show()
    return fig  # 确保返回Figure对象
```

代码说明：
数据加载：使用numpy读取文本格式的原始指数数据；

可视化展示：matplotlib绘制原始数据折线图；

傅里叶滤波：通过rfft进行实数傅里叶变换，按比例(10%/2%)截断高频系数，使用irfft还原滤波后信号。

效果对比：并排显示原始数据与滤波结果的差异。
