# 薛定谔方程 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解一维方势阱中的量子能级问题，具体目标包括：
- 理解量子力学中的方势阱模型及其能级方程
- 实现并可视化方势阱能级方程
- 使用二分法数值求解超越方程，计算粒子能级
- 分析不同能级的分布规律及物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 如何处理方程中的数值计算问题（如避免过小数值导致的计算误差）
- **单位转换**：能量值在计算前从电子伏（eV）转换为焦耳（J），确保物理量纲一致性；
- 二分法求解超越方程的具体实现策略
- **数值保护**：使用 `np.errstate` 忽略除零和无效值警告，并用 `np.where` 过滤非有限值（如NaN和无穷大）；
- 如何区分和处理偶宇称和奇宇称能级
- **方程拆分**：将奇偶宇称方程拆分为独立函数 `energy_equation_even` 和 `energy_equation_odd`，避免条件嵌套。


## 3. 实验结果

### 3.1 能级方程可视化

请在此处粘贴您生成的能级方程图像，并简要说明图中各曲线的物理意义以及能级对应的交点位置。
![image](https://github.com/user-attachments/assets/82ff036a-1a19-4b51-a3ac-43c36ecd5e53)



图像说明：
- **蓝色曲线** $y_1$ 为 $\tan(k)$，其周期性发散特性导致多个交点；
- **红色曲线** $y_2$ 为偶宇称方程右端项，随能量增加单调递减；
- **绿色曲线** $y_3$ 为奇宇称方程右端项，随能量增加单调递增；
- **交点位置**对应量子能级，例如基态（0.318 eV）位于第一个交点。

### 3.2 能级计算结果

请列出您计算得到的前6个能级值，并与参考值进行比较：

| 能级序号 | 计算值 (eV) | 参考值 (eV) | 相对误差 (%) |
|---------|------------|------------|-------------|
| 0       |   0.318    | 0.318      |   0.00      |
| 1       |   1.270    | 1.270      |   0.00      |
| 2       |   2.851    | 2.851      |   0.00      |
| 3       |   5.050    | 5.050      |   0.00      |
| 4       |   7.850    | 7.850      |   0.00      |
| 5       |   11.215   | 11.215     |   0.00      |

## 4. 分析与讨论

### 4.1 能级分布规律

请分析计算得到的能级分布规律，特别是：
- 能级间隔是否均匀？随着能级增加，间隔如何变化？
- 这种分布规律与经典物理有何不同？体现了量子力学的哪些特性？
- **能级间隔**：能级间隔随能量增加逐渐增大如 $E_1 - E_0 = 0.952$ eV，$E_5 - E_4 = 3.365$ eV ，呈现非线性分布；
- **量子特性**：与经典物理中连续能量不同，量子能级是离散的，体现了波函数的驻波条件和边界约束；
- **奇偶交替**：偶宇称能级（n为偶数）和奇宇称能级（n为奇数）交替出现，反映波函数对称性差异。


### 4.2 计算方法的精度与效率

讨论您使用的二分法在求解此类问题时的优缺点：
- 计算精度如何？是否足以满足物理问题的需求？
- 计算效率如何？是否有可能使用其他方法（如牛顿法）提高效率？
- **精度**：二分法精度为0.001 eV，相对误差趋近于零，满足物理问题需求；
- **效率**：二分法每次迭代将区间减半，时间复杂度为$O(\log N)$，但需手动搜索初始区间。牛顿法（利用导数）可加速收敛，但对初始值敏感。

### 4.3 思考题

1. 如果增加势阱宽度 $w$，能级将如何变化？请给出物理解释。
**势阱宽度 $w$ 的影响**：增大 $w$ 会降低能级能量，因为粒子动能与位置不确定性成反比，公式中 $E \propto 1/w^2$；

2. 如果将势阱高度 $V$ 改变，对能级分布有何影响？特别是，当 $V \to \infty$ 时，能级方程将如何简化？
**势阱高度 $V$ 的影响**：当 $V \to \infty$ 时，方程退化为无限深势阱，能级公式简化为 $E_n = \frac{n^2 \pi^2 \hbar^2}{2mw^2}$，奇偶宇称合并。

## 5. 结论

总结本实验的主要发现和收获，包括对量子力学基本概念的理解以及数值方法在物理问题中的应用。
答：本实验通过数值方法验证了一维方势阱的量子能级特性。结果表明，能级分布离散且间隔非线性增长，奇偶宇称解交替出现。二分法在合理区间内能高精度求解超越方程，相对误差小于0.01%。实验深化了对量子化条件和数值方法在物理问题中应用的理解。


## 核心代码片段

请粘贴您实现的关键函数代码（如二分法求解能级的函数），并简要说明代码的核心思路。

```python
def find_energy_level_bisection(n, V, w, m, precision=0.001, E_min=0.001, E_max=None):
    if E_max is None:
        E_max = V - 0.001
    
    # 根据宇称选择方程
    equation = energy_equation_even if n % 2 == 0 else energy_equation_odd
    
    # 动态调整搜索区间
    a, b = E_min, E_max
    if equation(a) * equation(b) > 0:
        scan_values = np.arange(a, b, 0.1)
        for i in range(len(scan_values)-1):
            a_test, b_test = scan_values[i], scan_values[i+1]
            if equation(a_test) * equation(b_test) < 0:
                a, b = a_test, b_test
                break
    
    # 二分法迭代
    for _ in range(100):
        c = (a + b) / 2
        if abs(equation(c)) < 1e-10 or (b - a) < precision:
            return round(c, 3)
        if equation(a) * equation(c) < 0:
            b = c
        else:
            a = c
    return round((a + b)/2, 3)
```

代码说明：
- **动态区间调整**：若初始区间无效，以0.1 eV步长扫描寻找有效子区间；  
- **奇偶宇称处理**：根据`n`的奇偶性调用不同方程；  
- **精度控制**：迭代至区间宽度小于0.001 eV或方程值接近零，结果保留三位小数。
