# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据获取和预处理的方法
- 傅里叶变换的实现方式
- 功率谱的计算方法
- 峰值检测和周期确定的策略

1.数据获取与预处理
通过load_sunspot_data函数从本地文件（sunspot_data.txt）加载数据，使用numpy.loadtxt读取年份和太阳黑子数列。注释中还包含从URL获取数据的备用代码，但未被实际调用。数据预处理仅保留有效数值，未进行插值或平滑处理。

2.傅里叶变换实现
在compute_power_spectrum函数中，直接调用np.fft.fft对太阳黑子数据进行快速傅里叶变换（FFT），将时域信号转换为频域表示。FFT结果包含正负频率，后续仅使用正频率部分以简化分析。

3.功率谱计算方法
功率谱通过取FFT结果的绝对值平方（np.abs(fft_result)**2）得到，反映信号在不同频率上的能量分布。横轴频率通过np.fft.fftfreq生成，转换为周期（月）后绘图。

4.峰值检测与周期确定
主周期通过find_main_period函数定位功率谱中的最高峰值（忽略零频），其对应周期为1/frequency。代码输出主周期（月）并转换为年单位，验证了太阳活动的11年周期特征。

## 3. 实验结果

### 3.1 太阳黑子数据时间序列

![Figure_1](https://github.com/user-attachments/assets/a34e1000-8e92-4cb9-8073-2aac744ab031)

图像说明：

该图展示了自1749年至今太阳黑子数量的变化趋势。横轴为年份，纵轴为太阳黑子数。图中可见明显的周期性波动，峰值和谷值交替出现，周期约为11年，这是太阳活动的基本周期。此外，不同周期的峰值高度不一，表明太阳活动强度存在长期变化。整体来看，太阳黑子数在20世纪后半叶达到较高水平，可能与现代太阳活动增强有关。
### 3.2 功率谱分析

![Figure_2](https://github.com/user-attachments/assets/a0956daa-a56b-49a1-856e-be0dbdc50eb4)

图像说明：

该图是太阳黑子数据的功率谱分析结果，横轴为周期（月），纵轴为功率。图中显著峰值对应的周期约为132个月（11年），证实了太阳活动的11年周期。其他较小峰值可能反映次级的周期成分或噪声。功率谱分析揭示了太阳黑子变化的主要频率特征，为研究太阳活动规律提供了重要依据。

### 3.3 周期确定

请列出您通过不同方法确定的太阳黑子周期：

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 | 138.00  |   11.50   |
| 傅里叶分析 | 132.64 |   11.05   |

两种方法的相对误差： 4.07%

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

请讨论太阳黑子周期的物理成因及其对地球的影响：
- 太阳黑子形成的物理机制是什么？
- 太阳黑子周期与太阳磁场活动有什么关系？
- 太阳黑子活动对地球气候、通信系统等有何影响？

太阳黑子物理机制：太阳黑子是强磁场抑制对流形成的低温暗斑，源于太阳内部差动旋转扭曲磁场，磁通量管浮出光球层形成极性相反的黑子对。

周期与磁场关系：11年周期（实际22年，含磁场反转）由太阳发电机效应驱动，磁场周期性重组导致黑子数量变化，极大期耀斑和日冕物质抛射增多。

对地球影响：气候：活动强弱可能影响全球温度（如小冰期）；通信：耀斑干扰电离层，破坏短波通信和卫星；电网：高能粒子可引发大范围停电。

### 4.2 傅里叶变换方法的优缺点

讨论使用傅里叶变换分析周期性信号的优缺点：
- 傅里叶变换在分析周期性信号时的优势是什么？
- 在本实验中，傅里叶变换方法可能存在哪些局限性？
- 有哪些其他方法可以用来分析时间序列的周期性？它们与傅里叶变换相比有何异同？

优势：

精确的频率定位：能准确提取信号中的周期成分，如本实验清晰识别出11年太阳黑子周期。

计算高效：FFT算法复杂度为O(NlogN)，适合处理长时间序列数据。

直观的频谱表示：功率谱直接展示各频率的能量分布，便于分析主导周期。

局限性：

假设信号平稳：太阳黑子活动可能存在长期趋势或非平稳性，导致频谱“泄露”。

分辨率受限：频率分辨率取决于数据长度，短时间序列可能漏检低频周期。

无法定位时间信息：难以分析周期强度的时变特征（如太阳活动周期的强弱变化）。

替代方法：

小波变换：可同时提供时频信息，适合非平稳信号，但计算更复杂。

Lomb-Scargle周期图：适用于非均匀采样数据，但对噪声敏感。

自相关分析：简单直观，但对多周期信号的分辨能力较弱。

### 4.3 思考题

1. 如果太阳黑子数据中存在长期趋势（如逐年增加或减少的趋势），这会如何影响傅里叶分析的结果？应该如何处理这种趋势？

若太阳黑子数据存在长期趋势（如逐年上升），傅里叶变换会将其误认为低频周期成分，导致功率谱在低频区出现虚假峰值，干扰真实周期（如11年周期）的检测。

处理方法：

去趋势化：通过线性拟合或高阶多项式拟合去除趋势项。

差分法：对数据做一阶或二阶差分，消除趋势影响。

滤波：使用高通滤波器（如Butterworth）直接滤除低频趋势。

2. 太阳黑子数据从1749年开始记录，到现在已有270多年的数据。如果我们只使用最近100年的数据进行分析，结果会有什么不同？为什么？

使用最近100年数据（1925-2025）分析太阳黑子周期，结果可能出现以下差异：

周期识别精度下降：数据长度缩短会降低傅里叶变换的频率分辨率，可能模糊11年周期的峰值，或遗漏次级周期（如世纪周期）。

局部活动特征凸显：短时间窗口可能放大近期太阳活动异常，但掩盖长期规律。

原因：傅里叶变换的频谱分辨率与数据时长成反比（Δf=1/T），且短时间序列对噪声更敏感。需结合更长数据验证周期性。
## 5. 结论

总结本实验的主要发现和收获，包括对太阳黑子周期性的认识以及傅里叶变换在周期性分析中的应用。

太阳黑子周期性：通过分析270多年的数据，功率谱在132个月（11年）处呈现显著峰值，证实了太阳活动的11年主周期，同时揭示了次级周期成分的存在，印证了太阳磁场的周期性反转机制。

傅里叶变换的应用价值：

优势：快速准确地提取信号中的主导频率（如11年周期），并通过功率谱直观展示能量分布。

局限：对非平稳信号（如长期趋势）敏感，需结合去趋势预处理。

方法认知：掌握了时频分析的基本流程（数据→时域图→频谱→周期提取），认识到傅里叶变换是周期性分析的基石，但需根据数据特性选择补充方法（如小波变换处理非平稳信号）。

## 核心代码片段

请粘贴您实现的关键函数代码（如傅里叶变换和功率谱计算），并简要说明代码的核心思路。

```python
def plot_sunspot_data(years, sunspots):
    """
    绘制太阳黑子数据随时间变化图
    
    参数:
        years (numpy.ndarray): 年份数组
        sunspots (numpy.ndarray): 太阳黑子数数组
    """
    plt.figure(figsize=(12, 6))
    plt.plot(years, sunspots)
    plt.xlabel('Year')
    plt.ylabel('Sunspot Number')
    plt.title('Sunspot Number Variation (1749-Present)')
    plt.grid(True)
    plt.show()

def compute_power_spectrum(sunspots):
    """
    计算太阳黑子数据的功率谱
    
    参数:
        sunspots (numpy.ndarray): 太阳黑子数数组
        
    返回:
        tuple: (frequencies, power) 频率数组和功率谱
    """
    
    # 傅里叶变换
    n = sunspots.size
    fft_result = np.fft.fft(sunspots)
    
    # 计算功率谱 (只取正频率部分)
    power = np.abs(fft_result[:n//2])**2
    frequencies = np.fft.fftfreq(n, d=1)[:n//2]  # 每月采样一次
    
    return frequencies, power
```

代码说明：

数据加载：从本地文件读取年份和黑子数，提取两列数据（load_sunspot_data）

可视化：绘制1749年至今的黑子数时序图（plot_sunspot_data）

频谱分析：对数据做FFT变换，计算功率谱并绘图（compute_power_spectrum + plot_power_spectrum）

周期提取：定位功率谱峰值，输出主周期（11年）（find_main_period）
